{
  "name": "portal",
  "tables": [
    {
      "name": "groups",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "parent_id",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL",
          "comment": "Parent group for hierarchical structure"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        },
        {
          "name": "updated_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)",
          "extra_def": "on update current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_groups_parent",
          "def": "KEY fk_groups_parent (parent_id) USING BTREE",
          "table": "groups",
          "columns": [
            "parent_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "groups",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_groups_parent",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (parent_id) REFERENCES groups (id)",
          "table": "groups",
          "referenced_table": "groups",
          "columns": [
            "parent_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "groups",
          "columns": [
            "id"
          ]
        }
      ],
      "def": "CREATE TABLE `groups` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `name` varchar(255) NOT NULL,\n  `description` text DEFAULT NULL,\n  `parent_id` char(36) DEFAULT NULL COMMENT 'Parent group for hierarchical structure',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  `updated_at` datetime(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `fk_groups_parent` (`parent_id`),\n  CONSTRAINT `fk_groups_parent` FOREIGN KEY (`parent_id`) REFERENCES `groups` (`id`) ON DELETE SET NULL ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "group_keys",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "group_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "user_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "key_id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "encrypted_key",
          "type": "blob",
          "nullable": false,
          "comment": "Group symmetric key encrypted with user public key"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_group_keys_user",
          "def": "KEY fk_group_keys_user (user_id) USING BTREE",
          "table": "group_keys",
          "columns": [
            "user_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (group_id, user_id, key_id) USING BTREE",
          "table": "group_keys",
          "columns": [
            "group_id",
            "user_id",
            "key_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_group_keys_group",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (group_id) REFERENCES groups (id)",
          "table": "group_keys",
          "referenced_table": "groups",
          "columns": [
            "group_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "fk_group_keys_user",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (user_id) REFERENCES users (id)",
          "table": "group_keys",
          "referenced_table": "users",
          "columns": [
            "user_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (group_id, user_id, key_id)",
          "table": "group_keys",
          "columns": [
            "group_id",
            "user_id",
            "key_id"
          ]
        }
      ],
      "def": "CREATE TABLE `group_keys` (\n  `group_id` char(36) NOT NULL,\n  `user_id` char(36) NOT NULL,\n  `key_id` char(36) NOT NULL COMMENT 'UUID v4',\n  `encrypted_key` blob NOT NULL COMMENT 'Group symmetric key encrypted with user public key',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`group_id`,`user_id`,`key_id`),\n  KEY `fk_group_keys_user` (`user_id`),\n  CONSTRAINT `fk_group_keys_group` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `fk_group_keys_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "group_members",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "group_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "user_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "roles",
          "type": "longtext",
          "nullable": false,
          "default": "'[]'",
          "comment": "Member roles within group: [\"admin\", \"owner\", \"member\"]"
        },
        {
          "name": "joined_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_group_members_user",
          "def": "KEY fk_group_members_user (user_id) USING BTREE",
          "table": "group_members",
          "columns": [
            "user_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (group_id, user_id) USING BTREE",
          "table": "group_members",
          "columns": [
            "group_id",
            "user_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_group_members_group",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (group_id) REFERENCES groups (id)",
          "table": "group_members",
          "referenced_table": "groups",
          "columns": [
            "group_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "fk_group_members_user",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (user_id) REFERENCES users (id)",
          "table": "group_members",
          "referenced_table": "users",
          "columns": [
            "user_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (group_id, user_id)",
          "table": "group_members",
          "columns": [
            "group_id",
            "user_id"
          ]
        },
        {
          "name": "roles",
          "type": "CHECK",
          "def": "CHECK (json_valid(`roles`))",
          "table": "group_members"
        }
      ],
      "def": "CREATE TABLE `group_members` (\n  `group_id` char(36) NOT NULL,\n  `user_id` char(36) NOT NULL,\n  `roles` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL DEFAULT '[]' COMMENT 'Member roles within group: [\"admin\", \"owner\", \"member\"]' CHECK (json_valid(`roles`)),\n  `joined_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`group_id`,`user_id`),\n  KEY `fk_group_members_user` (`user_id`),\n  CONSTRAINT `fk_group_members_group` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,\n  CONSTRAINT `fk_group_members_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "group_member_logs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "group_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "user_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "action",
          "type": "varchar(32)",
          "nullable": false,
          "comment": "Action: added, removed, role_changed"
        },
        {
          "name": "actor_id",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL",
          "comment": "User who performed the action"
        },
        {
          "name": "old_roles",
          "type": "longtext",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "new_roles",
          "type": "longtext",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "idx_group_member_logs_group",
          "def": "KEY idx_group_member_logs_group (group_id) USING BTREE",
          "table": "group_member_logs",
          "columns": [
            "group_id"
          ]
        },
        {
          "name": "idx_group_member_logs_user",
          "def": "KEY idx_group_member_logs_user (user_id) USING BTREE",
          "table": "group_member_logs",
          "columns": [
            "user_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "group_member_logs",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "group_member_logs",
          "columns": [
            "id"
          ]
        },
        {
          "name": "old_roles",
          "type": "CHECK",
          "def": "CHECK (json_valid(`old_roles`))",
          "table": "group_member_logs"
        },
        {
          "name": "new_roles",
          "type": "CHECK",
          "def": "CHECK (json_valid(`new_roles`))",
          "table": "group_member_logs"
        }
      ],
      "def": "CREATE TABLE `group_member_logs` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `group_id` char(36) NOT NULL,\n  `user_id` char(36) NOT NULL,\n  `action` varchar(32) NOT NULL COMMENT 'Action: added, removed, role_changed',\n  `actor_id` char(36) DEFAULT NULL COMMENT 'User who performed the action',\n  `old_roles` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`old_roles`)),\n  `new_roles` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`new_roles`)),\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `idx_group_member_logs_group` (`group_id`),\n  KEY `idx_group_member_logs_user` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "group_permissions",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "group_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "permission",
          "type": "varchar(64)",
          "nullable": false,
          "comment": "Permission: user:read, user:update, invitation:create, etc."
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (group_id, permission) USING BTREE",
          "table": "group_permissions",
          "columns": [
            "group_id",
            "permission"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_group_permissions_group",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (group_id) REFERENCES groups (id)",
          "table": "group_permissions",
          "referenced_table": "groups",
          "columns": [
            "group_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (group_id, permission)",
          "table": "group_permissions",
          "columns": [
            "group_id",
            "permission"
          ]
        }
      ],
      "def": "CREATE TABLE `group_permissions` (\n  `group_id` char(36) NOT NULL,\n  `permission` varchar(64) NOT NULL COMMENT 'Permission: user:read, user:update, invitation:create, etc.',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`group_id`,`permission`),\n  CONSTRAINT `fk_group_permissions_group` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "invitations",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "code",
          "type": "varchar(20)",
          "nullable": false,
          "comment": "Invitation code (e.g., XXXX-XXXX-XXXX)"
        },
        {
          "name": "created_by",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL",
          "comment": "User who created this invitation"
        },
        {
          "name": "used_by",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL",
          "comment": "User who used this invitation"
        },
        {
          "name": "expires_at",
          "type": "datetime(6)",
          "nullable": true,
          "default": "NULL",
          "comment": "Expiration time (NULL = never expires)"
        },
        {
          "name": "used_at",
          "type": "datetime(6)",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_invitations_created_by",
          "def": "KEY fk_invitations_created_by (created_by) USING BTREE",
          "table": "invitations",
          "columns": [
            "created_by"
          ]
        },
        {
          "name": "fk_invitations_used_by",
          "def": "KEY fk_invitations_used_by (used_by) USING BTREE",
          "table": "invitations",
          "columns": [
            "used_by"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "invitations",
          "columns": [
            "id"
          ]
        },
        {
          "name": "uq_invitations_code",
          "def": "UNIQUE KEY uq_invitations_code (code) USING BTREE",
          "table": "invitations",
          "columns": [
            "code"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_invitations_created_by",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (created_by) REFERENCES users (id)",
          "table": "invitations",
          "referenced_table": "users",
          "columns": [
            "created_by"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "fk_invitations_used_by",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (used_by) REFERENCES users (id)",
          "table": "invitations",
          "referenced_table": "users",
          "columns": [
            "used_by"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "invitations",
          "columns": [
            "id"
          ]
        },
        {
          "name": "uq_invitations_code",
          "type": "UNIQUE",
          "def": "UNIQUE KEY uq_invitations_code (code)",
          "table": "invitations",
          "columns": [
            "code"
          ]
        }
      ],
      "def": "CREATE TABLE `invitations` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `code` varchar(20) NOT NULL COMMENT 'Invitation code (e.g., XXXX-XXXX-XXXX)',\n  `created_by` char(36) DEFAULT NULL COMMENT 'User who created this invitation',\n  `used_by` char(36) DEFAULT NULL COMMENT 'User who used this invitation',\n  `expires_at` datetime(6) DEFAULT NULL COMMENT 'Expiration time (NULL = never expires)',\n  `used_at` datetime(6) DEFAULT NULL,\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uq_invitations_code` (`code`),\n  KEY `fk_invitations_created_by` (`created_by`),\n  KEY `fk_invitations_used_by` (`used_by`),\n  CONSTRAINT `fk_invitations_created_by` FOREIGN KEY (`created_by`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,\n  CONSTRAINT `fk_invitations_used_by` FOREIGN KEY (`used_by`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "mails",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "to",
          "type": "text",
          "nullable": true,
          "default": "NULL",
          "comment": "Recipients (format: @trap_id;@trap_id2)"
        },
        {
          "name": "subject",
          "type": "varchar(255)",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "body",
          "type": "text",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "operator_id",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL",
          "comment": "User who sent this mail"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_mails_operator",
          "def": "KEY fk_mails_operator (operator_id) USING BTREE",
          "table": "mails",
          "columns": [
            "operator_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "mails",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_mails_operator",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (operator_id) REFERENCES users (id)",
          "table": "mails",
          "referenced_table": "users",
          "columns": [
            "operator_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "mails",
          "columns": [
            "id"
          ]
        }
      ],
      "def": "CREATE TABLE `mails` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `to` text DEFAULT NULL COMMENT 'Recipients (format: @trap_id;@trap_id2)',\n  `subject` varchar(255) DEFAULT NULL,\n  `body` text DEFAULT NULL,\n  `operator_id` char(36) DEFAULT NULL COMMENT 'User who sent this mail',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `fk_mails_operator` (`operator_id`),\n  CONSTRAINT `fk_mails_operator` FOREIGN KEY (`operator_id`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "mail_logs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "mail_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(32)",
          "nullable": false,
          "comment": "Status: unsent, sent, failed"
        },
        {
          "name": "error",
          "type": "text",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "idx_mail_logs_mail",
          "def": "KEY idx_mail_logs_mail (mail_id) USING BTREE",
          "table": "mail_logs",
          "columns": [
            "mail_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "mail_logs",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_mail_logs_mail",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (mail_id) REFERENCES mails (id)",
          "table": "mail_logs",
          "referenced_table": "mails",
          "columns": [
            "mail_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "mail_logs",
          "columns": [
            "id"
          ]
        }
      ],
      "def": "CREATE TABLE `mail_logs` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `mail_id` char(36) NOT NULL,\n  `status` varchar(32) NOT NULL COMMENT 'Status: unsent, sent, failed',\n  `error` text DEFAULT NULL,\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `idx_mail_logs_mail` (`mail_id`),\n  CONSTRAINT `fk_mail_logs_mail` FOREIGN KEY (`mail_id`) REFERENCES `mails` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "namecards",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "student_prefix",
          "type": "varchar(32)",
          "nullable": false,
          "comment": "Student number prefix (e.g., 15B, 24B)"
        },
        {
          "name": "color",
          "type": "varchar(32)",
          "nullable": true,
          "default": "NULL",
          "comment": "Hex color code"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (student_prefix) USING BTREE",
          "table": "namecards",
          "columns": [
            "student_prefix"
          ]
        }
      ],
      "constraints": [
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (student_prefix)",
          "table": "namecards",
          "columns": [
            "student_prefix"
          ]
        }
      ],
      "def": "CREATE TABLE `namecards` (\n  `student_prefix` varchar(32) NOT NULL COMMENT 'Student number prefix (e.g., 15B, 24B)',\n  `color` varchar(32) DEFAULT NULL COMMENT 'Hex color code',\n  PRIMARY KEY (`student_prefix`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "secrets",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "group_id",
          "type": "char(36)",
          "nullable": false,
          "comment": "Owning group"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "encrypted_value",
          "type": "blob",
          "nullable": false,
          "comment": "AES-GCM encrypted with group key"
        },
        {
          "name": "created_by",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        },
        {
          "name": "updated_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)",
          "extra_def": "on update current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_secrets_created_by",
          "def": "KEY fk_secrets_created_by (created_by) USING BTREE",
          "table": "secrets",
          "columns": [
            "created_by"
          ]
        },
        {
          "name": "idx_secrets_group",
          "def": "KEY idx_secrets_group (group_id) USING BTREE",
          "table": "secrets",
          "columns": [
            "group_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "secrets",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_secrets_created_by",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (created_by) REFERENCES users (id)",
          "table": "secrets",
          "referenced_table": "users",
          "columns": [
            "created_by"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "fk_secrets_group",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (group_id) REFERENCES groups (id)",
          "table": "secrets",
          "referenced_table": "groups",
          "columns": [
            "group_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "secrets",
          "columns": [
            "id"
          ]
        }
      ],
      "def": "CREATE TABLE `secrets` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `group_id` char(36) NOT NULL COMMENT 'Owning group',\n  `name` varchar(255) NOT NULL,\n  `encrypted_value` blob NOT NULL COMMENT 'AES-GCM encrypted with group key',\n  `created_by` char(36) DEFAULT NULL,\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  `updated_at` datetime(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `fk_secrets_created_by` (`created_by`),\n  KEY `idx_secrets_group` (`group_id`),\n  CONSTRAINT `fk_secrets_created_by` FOREIGN KEY (`created_by`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,\n  CONSTRAINT `fk_secrets_group` FOREIGN KEY (`group_id`) REFERENCES `groups` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "secret_logs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "secret_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "action",
          "type": "varchar(32)",
          "nullable": false,
          "comment": "Action: created, updated, deleted, accessed"
        },
        {
          "name": "actor_id",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "idx_secret_logs_secret",
          "def": "KEY idx_secret_logs_secret (secret_id) USING BTREE",
          "table": "secret_logs",
          "columns": [
            "secret_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "secret_logs",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "secret_logs",
          "columns": [
            "id"
          ]
        }
      ],
      "def": "CREATE TABLE `secret_logs` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `secret_id` char(36) NOT NULL,\n  `action` varchar(32) NOT NULL COMMENT 'Action: created, updated, deleted, accessed',\n  `actor_id` char(36) DEFAULT NULL,\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `idx_secret_logs_secret` (`secret_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "users",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "trap_id",
          "type": "varchar(32)",
          "nullable": false,
          "comment": "traP ID (unique username)"
        },
        {
          "name": "password_hash",
          "type": "varchar(255)",
          "nullable": false,
          "comment": "PBKDF2-SHA512 hash"
        },
        {
          "name": "email",
          "type": "varbinary(512)",
          "nullable": true,
          "default": "NULL",
          "comment": "AES-GCM encrypted email"
        },
        {
          "name": "personal_info",
          "type": "blob",
          "nullable": true,
          "default": "NULL",
          "comment": "AES-GCM encrypted JSON (name, phone, address, etc.)"
        },
        {
          "name": "student_number",
          "type": "varchar(8)",
          "nullable": true,
          "default": "NULL",
          "comment": "Student number (plaintext for lookup)"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        },
        {
          "name": "updated_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)",
          "extra_def": "on update current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "users",
          "columns": [
            "id"
          ]
        },
        {
          "name": "uq_users_student_number",
          "def": "UNIQUE KEY uq_users_student_number (student_number) USING BTREE",
          "table": "users",
          "columns": [
            "student_number"
          ]
        },
        {
          "name": "uq_users_trap_id",
          "def": "UNIQUE KEY uq_users_trap_id (trap_id) USING BTREE",
          "table": "users",
          "columns": [
            "trap_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "users",
          "columns": [
            "id"
          ]
        },
        {
          "name": "uq_users_student_number",
          "type": "UNIQUE",
          "def": "UNIQUE KEY uq_users_student_number (student_number)",
          "table": "users",
          "columns": [
            "student_number"
          ]
        },
        {
          "name": "uq_users_trap_id",
          "type": "UNIQUE",
          "def": "UNIQUE KEY uq_users_trap_id (trap_id)",
          "table": "users",
          "columns": [
            "trap_id"
          ]
        }
      ],
      "def": "CREATE TABLE `users` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `trap_id` varchar(32) NOT NULL COMMENT 'traP ID (unique username)',\n  `password_hash` varchar(255) NOT NULL COMMENT 'PBKDF2-SHA512 hash',\n  `email` varbinary(512) DEFAULT NULL COMMENT 'AES-GCM encrypted email',\n  `personal_info` blob DEFAULT NULL COMMENT 'AES-GCM encrypted JSON (name, phone, address, etc.)',\n  `student_number` varchar(8) DEFAULT NULL COMMENT 'Student number (plaintext for lookup)',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  `updated_at` datetime(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uq_users_trap_id` (`trap_id`),\n  UNIQUE KEY `uq_users_student_number` (`student_number`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "user_keys",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "user_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "key_id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "public_key",
          "type": "varbinary(4096)",
          "nullable": false,
          "comment": "User public key (DER format)"
        },
        {
          "name": "encrypted_private_key",
          "type": "blob",
          "nullable": false,
          "comment": "Private key encrypted with user password-derived key"
        },
        {
          "name": "algorithm",
          "type": "varchar(32)",
          "nullable": false,
          "default": "'RSA-OAEP-SHA256'",
          "comment": "Key algorithm"
        },
        {
          "name": "is_active",
          "type": "tinyint(1)",
          "nullable": false,
          "default": "1"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (user_id, key_id) USING BTREE",
          "table": "user_keys",
          "columns": [
            "user_id",
            "key_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_user_keys_user",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (user_id) REFERENCES users (id)",
          "table": "user_keys",
          "referenced_table": "users",
          "columns": [
            "user_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (user_id, key_id)",
          "table": "user_keys",
          "columns": [
            "user_id",
            "key_id"
          ]
        }
      ],
      "def": "CREATE TABLE `user_keys` (\n  `user_id` char(36) NOT NULL,\n  `key_id` char(36) NOT NULL COMMENT 'UUID v4',\n  `public_key` varbinary(4096) NOT NULL COMMENT 'User public key (DER format)',\n  `encrypted_private_key` blob NOT NULL COMMENT 'Private key encrypted with user password-derived key',\n  `algorithm` varchar(32) NOT NULL DEFAULT 'RSA-OAEP-SHA256' COMMENT 'Key algorithm',\n  `is_active` tinyint(1) NOT NULL DEFAULT 1,\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`user_id`,`key_id`),\n  CONSTRAINT `fk_user_keys_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "user_links",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "user_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "service",
          "type": "varchar(64)",
          "nullable": false,
          "comment": "Service name: twitter, github, discord, etc."
        },
        {
          "name": "external_id",
          "type": "varchar(255)",
          "nullable": true,
          "default": "NULL",
          "comment": "External service user ID"
        },
        {
          "name": "account_name",
          "type": "varchar(255)",
          "nullable": true,
          "default": "NULL",
          "comment": "Display name/handle on the service"
        },
        {
          "name": "access_token",
          "type": "varbinary(1024)",
          "nullable": true,
          "default": "NULL",
          "comment": "Encrypted OAuth access token (if stored)"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        },
        {
          "name": "updated_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)",
          "extra_def": "on update current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (user_id, service) USING BTREE",
          "table": "user_links",
          "columns": [
            "user_id",
            "service"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_user_links_user",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (user_id) REFERENCES users (id)",
          "table": "user_links",
          "referenced_table": "users",
          "columns": [
            "user_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (user_id, service)",
          "table": "user_links",
          "columns": [
            "user_id",
            "service"
          ]
        }
      ],
      "def": "CREATE TABLE `user_links` (\n  `user_id` char(36) NOT NULL,\n  `service` varchar(64) NOT NULL COMMENT 'Service name: twitter, github, discord, etc.',\n  `external_id` varchar(255) DEFAULT NULL COMMENT 'External service user ID',\n  `account_name` varchar(255) DEFAULT NULL COMMENT 'Display name/handle on the service',\n  `access_token` varbinary(1024) DEFAULT NULL COMMENT 'Encrypted OAuth access token (if stored)',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  `updated_at` datetime(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),\n  PRIMARY KEY (`user_id`,`service`),\n  CONSTRAINT `fk_user_links_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "user_statuses",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "user_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(64)",
          "nullable": false,
          "comment": "Status type: active, suspended, email-unconfirmed, etc."
        },
        {
          "name": "detail",
          "type": "varchar(255)",
          "nullable": true,
          "default": "NULL",
          "comment": "Additional detail/reason"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (user_id, status) USING BTREE",
          "table": "user_statuses",
          "columns": [
            "user_id",
            "status"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_user_statuses_user",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (user_id) REFERENCES users (id)",
          "table": "user_statuses",
          "referenced_table": "users",
          "columns": [
            "user_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (user_id, status)",
          "table": "user_statuses",
          "columns": [
            "user_id",
            "status"
          ]
        }
      ],
      "def": "CREATE TABLE `user_statuses` (\n  `user_id` char(36) NOT NULL,\n  `status` varchar(64) NOT NULL COMMENT 'Status type: active, suspended, email-unconfirmed, etc.',\n  `detail` varchar(255) DEFAULT NULL COMMENT 'Additional detail/reason',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`user_id`,`status`),\n  CONSTRAINT `fk_user_statuses_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "webhooks",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "char(36)",
          "nullable": false,
          "comment": "UUID v4"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "url",
          "type": "varchar(2048)",
          "nullable": false
        },
        {
          "name": "secret",
          "type": "varbinary(512)",
          "nullable": true,
          "default": "NULL",
          "comment": "HMAC signing secret (encrypted)"
        },
        {
          "name": "owner_id",
          "type": "char(36)",
          "nullable": true,
          "default": "NULL",
          "comment": "User who owns this webhook"
        },
        {
          "name": "is_active",
          "type": "tinyint(1)",
          "nullable": false,
          "default": "1"
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        },
        {
          "name": "updated_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)",
          "extra_def": "on update current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "fk_webhooks_owner",
          "def": "KEY fk_webhooks_owner (owner_id) USING BTREE",
          "table": "webhooks",
          "columns": [
            "owner_id"
          ]
        },
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (id) USING BTREE",
          "table": "webhooks",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_webhooks_owner",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (owner_id) REFERENCES users (id)",
          "table": "webhooks",
          "referenced_table": "users",
          "columns": [
            "owner_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "webhooks",
          "columns": [
            "id"
          ]
        }
      ],
      "def": "CREATE TABLE `webhooks` (\n  `id` char(36) NOT NULL COMMENT 'UUID v4',\n  `name` varchar(255) NOT NULL,\n  `url` varchar(2048) NOT NULL,\n  `secret` varbinary(512) DEFAULT NULL COMMENT 'HMAC signing secret (encrypted)',\n  `owner_id` char(36) DEFAULT NULL COMMENT 'User who owns this webhook',\n  `is_active` tinyint(1) NOT NULL DEFAULT 1,\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  `updated_at` datetime(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),\n  PRIMARY KEY (`id`),\n  KEY `fk_webhooks_owner` (`owner_id`),\n  CONSTRAINT `fk_webhooks_owner` FOREIGN KEY (`owner_id`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    },
    {
      "name": "webhook_subscribe_events",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "webhook_id",
          "type": "char(36)",
          "nullable": false
        },
        {
          "name": "event_type",
          "type": "varchar(64)",
          "nullable": false,
          "comment": "Event type: user.created, group.member_added, etc."
        },
        {
          "name": "created_at",
          "type": "datetime(6)",
          "nullable": false,
          "default": "current_timestamp(6)"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "def": "PRIMARY KEY (webhook_id, event_type) USING BTREE",
          "table": "webhook_subscribe_events",
          "columns": [
            "webhook_id",
            "event_type"
          ]
        }
      ],
      "constraints": [
        {
          "name": "fk_webhook_events_webhook",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (webhook_id) REFERENCES webhooks (id)",
          "table": "webhook_subscribe_events",
          "referenced_table": "webhooks",
          "columns": [
            "webhook_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "PRIMARY",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (webhook_id, event_type)",
          "table": "webhook_subscribe_events",
          "columns": [
            "webhook_id",
            "event_type"
          ]
        }
      ],
      "def": "CREATE TABLE `webhook_subscribe_events` (\n  `webhook_id` char(36) NOT NULL,\n  `event_type` varchar(64) NOT NULL COMMENT 'Event type: user.created, group.member_added, etc.',\n  `created_at` datetime(6) NOT NULL DEFAULT current_timestamp(6),\n  PRIMARY KEY (`webhook_id`,`event_type`),\n  CONSTRAINT `fk_webhook_events_webhook` FOREIGN KEY (`webhook_id`) REFERENCES `webhooks` (`id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci"
    }
  ],
  "relations": [
    {
      "table": "groups",
      "columns": [
        "parent_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "groups",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (parent_id) REFERENCES groups (id)"
    },
    {
      "table": "group_keys",
      "columns": [
        "group_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "groups",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (group_id) REFERENCES groups (id)"
    },
    {
      "table": "group_keys",
      "columns": [
        "user_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (user_id) REFERENCES users (id)"
    },
    {
      "table": "group_members",
      "columns": [
        "group_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "groups",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (group_id) REFERENCES groups (id)"
    },
    {
      "table": "group_members",
      "columns": [
        "user_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (user_id) REFERENCES users (id)"
    },
    {
      "table": "group_permissions",
      "columns": [
        "group_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "groups",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (group_id) REFERENCES groups (id)"
    },
    {
      "table": "invitations",
      "columns": [
        "created_by"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (created_by) REFERENCES users (id)"
    },
    {
      "table": "invitations",
      "columns": [
        "used_by"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (used_by) REFERENCES users (id)"
    },
    {
      "table": "mails",
      "columns": [
        "operator_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (operator_id) REFERENCES users (id)"
    },
    {
      "table": "mail_logs",
      "columns": [
        "mail_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "mails",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (mail_id) REFERENCES mails (id)"
    },
    {
      "table": "secrets",
      "columns": [
        "created_by"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (created_by) REFERENCES users (id)"
    },
    {
      "table": "secrets",
      "columns": [
        "group_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "groups",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (group_id) REFERENCES groups (id)"
    },
    {
      "table": "user_keys",
      "columns": [
        "user_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (user_id) REFERENCES users (id)"
    },
    {
      "table": "user_links",
      "columns": [
        "user_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (user_id) REFERENCES users (id)"
    },
    {
      "table": "user_statuses",
      "columns": [
        "user_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (user_id) REFERENCES users (id)"
    },
    {
      "table": "webhooks",
      "columns": [
        "owner_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "users",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (owner_id) REFERENCES users (id)"
    },
    {
      "table": "webhook_subscribe_events",
      "columns": [
        "webhook_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "webhooks",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (webhook_id) REFERENCES webhooks (id)"
    }
  ],
  "driver": {
    "name": "mariadb",
    "database_version": "12.1.2-MariaDB-ubu2404",
    "meta": {
      "dict": {
        "Functions": "Stored procedures and functions"
      }
    }
  }
}
